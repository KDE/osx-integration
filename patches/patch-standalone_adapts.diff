--- a/qmacstyle_mac.mm	2017-03-31 13:28:18.000000000 +0200
+++ b/qmacstyle_mac.mm	2017-04-04 18:03:15.000000000 +0200
@@ -53,6 +53,7 @@
 #include <private/qcore_mac_p.h>
 #include <private/qcombobox_p.h>
 #include <private/qpainter_p.h>
+#include <private/qapplication_p.h>
 #include <qapplication.h>
 #include <qbitmap.h>
 #include <qcheckbox.h>
@@ -92,8 +93,8 @@
 #include <QtWidgets/qgraphicsproxywidget.h>
 #include <QtWidgets/qgraphicsview.h>
 #include <QtCore/qvariant.h>
-#include <private/qstylehelper_p.h>
-#include <private/qstyleanimation_p.h>
+#include "qstylehelper_p.h"
+#include "qstyleanimation_p.h"
 #include <qpa/qplatformfontdatabase.h>
 #include <qpa/qplatformtheme.h>
 #include <QtGui/private/qcoregraphics_p.h>
@@ -151,6 +152,12 @@
 
 QVector<QPointer<QObject> > QMacStylePrivate::scrollBars;
 
+Q_GLOBAL_STATIC(FontHash, app_fonts)
+FontHash *qt_app_fonts_hash()
+{
+    return app_fonts();
+}
+
 // Title bar gradient colors for Lion were determined by inspecting PSDs exported
 // using CoreUI's CoreThemeDocument; there is no public API to retrieve them
 
@@ -3828,7 +3835,8 @@
             }
 
             // TODO: find out the pressed button in a qwidget independent way
-            extern QWidget *qt_button_down; // qwidgetwindow.cpp
+//             extern QWidget *qt_button_down; // qwidgetwindow.cpp
+            QWidget *qt_button_down = nullptr;
             if (opt->styleObject == qt_button_down)
                 d->pressedButton = opt->styleObject;
             else if (d->pressedButton == opt->styleObject)

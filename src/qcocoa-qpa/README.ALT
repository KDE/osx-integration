20180828 : upstream head (5.9): f1a857c079e11c8e298ec8f2dafef49039f8ca40
touched:
 src/plugins/platforms/cocoa/qcocoamenu.h                                            |     4 +
 src/plugins/platforms/cocoa/qcocoamenu.mm                                           |    26 +-
 src/plugins/platforms/cocoa/qcocoamenubar.mm                                        |     2 +-
 src/plugins/platforms/cocoa/qcocoaprintersupport.h                                  |     2 +-
 src/plugins/platforms/cocoa/qcocoaprintersupport.mm                                 |     4 +-
 src/plugins/platforms/cocoa/qcocoawindow.mm                                         |    14 +-
 src/plugins/platforms/cocoa/qnsview.h                                               |     2 +
 src/plugins/platforms/cocoa/qnsview.mm                                              |     4 +
 src/plugins/platforms/cocoa/qprintengine_mac.mm                                     |     8 +-
 src/plugins/platforms/cocoa/qprintengine_mac_p.h                                    |     2 +-
patch: patches/21-sync-upstream-170828.diff
Changes: git log 0a5f71c6062d575602ff041fb1b88ec2d8ad92bc..HEAD src/plugins/platforms/cocoa
 commit dbaa4de28e5cdfa1787af77d236586833786ee61
    Cocoa: Fix compile when using QT_NO_TABLETEVENT
 commit 8ebfe00f4ab79516a8276929a682c24f4c675b5f
    Initialize the print engine with the given printer name
    QAltCocoa: only on Qt >= 5.9.0
    Task-number: QTBUG-62221
 commit 306071e50eac8290d234caab90985ddf705a5fc6
    QCocoaMenu: Sync menubar menu when adding items
    Task-number: QTBUG-62260
 commit f27d1ccbb24ec2fd4098f2976503478831006cc8
    QCocoaMenu: De-pessimize the number of calls to validateMenuItem:
    Task-number: QTBUG-62396
 commit c35fc435950437d3d046b17d06593873d7b82011
    macOS: Make alpha-based click-trough work again
    Restore 5.6 behavior by not modifying ignoresMouseEvent
    if we can. Toggling WindowTransparentForInput on and
    off again is still broken.
    Task-number: QTBUG-54830


20180802: upstream head (5.9): 0a5f71c6062d575602ff041fb1b88ec2d8ad92bc
touched:
 src/plugins/platforms/cocoa/cocoa.pro                                             |   7 +-
 src/plugins/platforms/cocoa/qcocoafontdialoghelper.h                              |   3 +
 src/plugins/platforms/cocoa/qcocoafontdialoghelper.mm                             |   4 -
 src/plugins/platforms/cocoa/qcocoahelpers.h                                       |   7 +-
 src/plugins/platforms/cocoa/qcocoahelpers.mm                                      |   5 ++
 src/plugins/platforms/cocoa/qcocoatheme.mm                                        |  13 +--
 src/plugins/platforms/cocoa/qnswindowdelegate.mm                                  |   7 +-
> patch: patches/20-sync-upstream-170801.diff
Changes:
    Fix 32-bit build on macOS
    macOS: Don't assume the proposed fullscreen size matches the screen size
      Sometimes AppKit will pass in a proposed size that's smaller than the
      geometry of the screen. We don't know why, but shouldn't assert.
    Add missing #include for -no-widgets
    macOS: Fix unused variable in window:willUseFullScreenContentSize:
    Convert features.fontdialog to QT_[REQUIRE_]CONFIG
    Fix macOS build for -no-widgets, take 2

20170707: upstream head (5.9): 9d3cd2268ce3beafcf6fa886bb70d8463260d602
touched:
 src/plugins/platforms/cocoa/qcocoatheme.mm
 src/plugins/platforms/cocoa/qnswindowdelegate.mm
> patch: patches/19.2-sync-upstream-170707.diff
Changes: from git log 03b4838cb51513bd5d2edf76dccc4bc4a1181681..HEAD src/plugins/platforms/cocoa/{qcocoatheme.mm,qnswindowdelegate.mm}
commit 9d3cd2268ce3beafcf6fa886bb70d8463260d602
Author: Tor Arne Vestb#c3#b8 <tor.arne.vestbo@qt.io>
Date:   Thu Jul 6 17:03:41 2017 +0200
    macOS: Account for fullscreen geometry bug in AppKit on OS X 10.10
commit 6a1046e17691c6e35c7384590ba241edb4082707
Author: Stephan Binner <stephan.binner@basyskom.com>
Date:   Tue Jul 4 19:08:55 2017 +0200
    Fix macOS build for -no-widgets


20170705: upstream head (5.9 branch): 03b4838cb51513bd5d2edf76dccc4bc4a1181681
touched:
 src/plugins/platforms/cocoa/cocoa.pro                                              |  16 +++--
 src/plugins/platforms/cocoa/qcocoacolordialoghelper.h                              |   4 ++
 src/plugins/platforms/cocoa/qcocoacolordialoghelper.mm                             |   4 --
 src/plugins/platforms/cocoa/qcocoafiledialoghelper.h                               |   3 +
 src/plugins/platforms/cocoa/qcocoafiledialoghelper.mm                              |   4 --
 src/plugins/platforms/cocoa/qcocoaintegration.mm                                   |   8 ++-
 src/plugins/platforms/cocoa/qcocoamenubar.mm                                       |  18 ++++-
 src/plugins/platforms/cocoa/qcocoatheme.mm                                         |  14 ++--
 src/plugins/platforms/cocoa/qnsview.mm                                             |  33 +++++----
> patch: patches/19-sync-upstream-170705.diff
Main changes from `cd src/plugins/platforms/cocoa && git log b2cb83ecbb1eec29268852d1b230f37e4c8592e9..HEAD cocoa.pro qcocoacolordialoghelper.h qcocoacolordialoghelper.mm qcocoafiledialoghelper.h qcocoafiledialoghelper.mm qcocoaintegration.mm qcocoamenubar.mm qcocoatheme.mm qnsview.mm `
commit 3e8ebea95b634c7ded9ee0b884768155e9e7f686
Author: Andy Shaw <andy.shaw@qt.io>
Date:   Fri Jun 23 09:08:19 2017 +0200
    Cocoa: Reset the target + action for a menuitem after showing a dialog
    To make it more reliable and efficient we now do the reverse of what we
    are doing when redirecting the items. This will ensure that the actions
    are correctly reset to the original target and action. The original
    approach of updateMenubarImmediately() was not always doing this and it
    also does other unnecessary things as a result when all we need is to
    just reset the things we changed.
commit 198b67d14bf3ca76d6bdf8901348da0838cf3b8d
Author: Tor Arne Vestb#c3#b8 <tor.arne.vestbo@qt.io>
Date:   Mon Jun 12 17:58:41 2017 +0200
    macOS: Send text input and key events to focus object of window, not app
    The key events and input method callbacks coming from Cocoa are targeted
    at our specific NSView, so we should deliver them to the focus object of
    the corresponding QWindow, not the global application focus object.
    This means that we'll deliver key events to windows also when they are
    not key (active), but this is intentional, as we would otherwise fail
    to deliver input method events coming from e.g. the emoji/symbol picker,
    which steals the key window when active.
    Task-number: QTBUG-61359
commit 3851a8ff20c6aed0807bfdc4588ae108a2b108ec
Author: Tor Arne Vestb#c3#b8 <tor.arne.vestbo@qt.io>
Date:   Fri Jun 23 13:32:25 2017 +0200
    macOS: Work around buildup of NSDisplayCycle objects during rapid painting
    Task-number: QTBUG-60012


commit e6ccc8e56fdaf402602130176064ffb1a0ce29bf
Author: R.J.V. Bertin <rjvbertin@gmail.com>
Date:   Wed Jun 21 18:16:04 2017 +0200

    sync with upstream Cocoa QPA changes in the 5.9 branch (qtbase v5.9.0-208-gb2cb83e)

commit 12e9ff4bed9513fe8ed390a1f421d8f73c45960a
Author: R.J.V. Bertin <rjvbertin@gmail.com>
Date:   Mon Jun 5 17:40:51 2017 +0200

    sync with upstream Cocoa QPA changes in the 5.9 branch (qtbase v5.9.0-119-g934235e)

commit 0ecceaf6d7871b
fc42141909af210f6bb408ac61
Author: R.J.V. Bertin <rjvbertin@gmail.com>
Date:   Thu Apr 20 20:50:58 2017 +0200

    15-patch-restore-legacy-fullscreen-mode.diff
    alternative fullscreen mode: simplified and restore window icons

<snip>

commit d4ce302e7c08dcf38a0f0f40b7e9183cab2fc2b1
Author: R.J.V. Bertin <rjvbertin@gmail.com>
Date:   Wed Apr 19 23:58:24 2017 +0200

    AltCocoa QPA: add a legacy fullscreen mode
    
    When windows don't have the fullscreen titlebar button or the env. var.
    QT_LEGACY_FULLSCREEN is set, toggleFullScreen() adopts a legacy mode.
    Windows are then made fullscreen by converting them to frame-less and
    resizing them to the current screen size.
    This is faster (instantaneous) and preserves display content on other
    screens in multi-head set-ups.

commit 85bb84969c6922667ff83e1483a7ef71628c046e
Author: R.J.V. Bertin <rjvbertin@gmail.com>
Date:   Tue Apr 11 20:16:12 2017 +0200

    qmacstyle : really build against Qt 5.8.0

<snip>

commit 934afde2c352b401cfffed83cb0877462dc27787
Author: R.J.V. Bertin <rjvbertin@gmail.com>
Date:   Mon Apr 10 23:56:13 2017 +0200

    modified (Alt) 5.9.0

commit c8dd86fd23c6787f949c2849ccb20eaf22e118ae
Author: R.J.V. Bertin <rjvbertin@gmail.com>
Date:   Mon Apr 10 23:45:31 2017 +0200

    13-themehint-add-aqua.diff

commit cbf229875c49c2a57d7b62b641d866134e569a1a
Author: R.J.V. Bertin <rjvbertin@gmail.com>
Date:   Thu Apr 6 21:57:00 2017 +0200

    12-deactivate-menurole-heuristics.patch
    
    this patch deactivates the worst of the TextHeuristic menu role guessmatics
    that can lead to putting the wrong QAction under the Mac's About or
    Preferences menu items in the Application menu. Many KDE applications have
    more than 1 About and Configure menu actions and are thus especially
    at risk.
    KDE applications that use KStandardActions to create the standard menu items
    will see the appropriate actions assigned to the About and Preferences
    menu items because their roles are set explicitly.

commit af7c4544d1883e9978609742b48dbb152e880c34
Author: R.J.V. Bertin <rjvbertin@gmail.com>
Date:   Thu Apr 6 21:50:46 2017 +0200

    11-patch-keyboard-support-menukey.diff
    
    this patch introduces support for a Menu key. Macs don't normally have one
    but the SDKs do provide a special keysym (NSMenuFunctionKey) which might be
    used (generated) by 3rd party keyboard drivers or even a native event filter.
    The patch completes the pre-existing support and generates a ContextMenu
    event at an appropriate location when the keysym is received.

commit c45430fc3c1827b44dd9002932b7b582da19729e
Author: R.J.V. Bertin <rjvbertin@gmail.com>
Date:   Thu Apr 6 19:22:14 2017 +0200

    10-patch-keyboard-mapping.diff
    
    From 3ee093b47109e2b24ab77ccdecde84437c5aced9 Mon Sep 17 00:00:00 2001
    From: Timur Pocheptsov <timur.pocheptsov@qt.io>
    Date: Wed, 2 Nov 2016 14:19:26 +0100
    Subject: [PATCH] WIP - Cocoa integration: fix incorrect keyboard mapping
    
    When switching between different input sources, we have to update layouts.
    
    Task-number: QTBUG-50865
    Change-Id: I19ee45feabf014e61dfef7454b5468e596ce2786
    Committed from host : Portia.local

commit 65de5666d5574a08a2fe49b82f29fd0b8a6b3cbf
Author: R.J.V. Bertin <rjvbertin@gmail.com>
Date:   Thu Apr 6 19:21:36 2017 +0200

    09-patch-silence-setscreen-warning.diff
    
    Prevent an unnecessary warning

commit 07527d713953a417b93393558cfb44475bc42d23
Author: R.J.V. Bertin <rjvbertin@gmail.com>
Date:   Thu Apr 6 19:20:56 2017 +0200

    08-patch-freetype-gamma-cocoa.diff
    
    Adapt the font smoothing gamma when using the FreeType rendering engine.

commit a7b0481d07c592c1a1810160e317d6792eeb7a5d
Author: R.J.V. Bertin <rjvbertin@gmail.com>
Date:   Thu Apr 6 19:19:32 2017 +0200

    06-patch-respect-DontSwapCtrlMeta.diff
    
    From ce953f011356257c1e1862d0353f785453559028 Mon Sep 17 00:00:00 2001
    From: Dyami Caliri <dyami@dragonframe.com>
    Date: Tue, 16 Sep 2014 17:32:22 -0700
    Subject: [PATCH] OS X: Handle Qt::AA_MacDontSwapCtrlAndMeta for regular key
     events
    
    The flag Qt::AA_MacDontSwapCtrlAndMeta was only being used with shortcut
    detection. Now trying to incorporate flag in normal key events.
    
    Task-number: QTBUG-22775
    Change-Id: I9edf97d0de93aa225435c9802372e33641cdac73
    Committed from host : Portia.local

commit 5ffc2fff1bd729ec9e54120e424fdfd51197f438
Author: R.J.V. Bertin <rjvbertin@gmail.com>
Date:   Thu Apr 6 19:18:46 2017 +0200

    05-patch-improve-fontweight-support9.diff
    
    part of a more comprehensive patch improving support for less-common font
    weights. I'm not sure how much effect it has on its own but it should not
    have adverse effects when used without the companion modifications.

commit 658f1d0e2fe5a9a678bdae712cc5a47878bc59de
Author: R.J.V. Bertin <rjvbertin@gmail.com>
Date:   Thu Apr 6 19:16:29 2017 +0200

    04-patch-qmenuAddSection.diff
    
    add support for named menu sections ("texted separators") in menus that
    are part of the native menubar. This requires the companion patch to the
    "native" Macintosh theme otherwise named sections won't appear when they
    are the 1st item in a menu.

commit 42f58e14282bf4beae408f5440397dd5a6b30471
Author: R.J.V. Bertin <rjvbertin@gmail.com>
Date:   Thu Apr 6 19:14:00 2017 +0200

    03-patch-better-menuitem-insert-warning.diff
    
    Provide a more helpful warning when adding an item to an additional menu
    or removing it from the wrong menu.

commit f5bbcfc20e52dfcfa27eedb4a1240e2fccf5fb93
Author: R.J.V. Bertin <rjvbertin@gmail.com>
Date:   Thu Apr 6 19:12:01 2017 +0200

    02-patch-enable-kde-theme.diff
    
    advertise the existence of support for the KDE platform theme plugin
    when KDE_SESSION_VERSION is set to at least 4 in the environment.

commit f3707f1516f1393235c178d5829cf3f88d5844e1
Author: R.J.V. Bertin <rjvbertin@gmail.com>
Date:   Thu Apr 6 19:03:23 2017 +0200

    01-patch-missing-autoreleasepools.diff
    
    Add autorelease pools to functions that (used to) need them. This is safe
    and comes at almost no cost.
